<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Hoteleaseali · Registro</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="icon" href="../img/logo.png">
</head>
<body>
<header>
  <div class="container header-inner">
    <a class="brand" href="../index.html"><img src="../img/logo.png" alt="">Hoteleaseali</a>
    <nav class="nav"><a href="./login.html">Iniciar sesión</a><a href="./panel.html">Panel</a></nav>
  </div>
</header>

<main class="container" style="padding:32px 0">
  <div class="card" style="max-width:720px;margin:auto">
    <h1>Crear cuenta</h1>
    <p class="lead">Regístrate con tu correo electrónico.</p>

    <form id="register-form" class="form-row" style="margin-top:12px">
      <label>Nombre (opcional)
        <input name="name" type="text" placeholder="Tu nombre">
      </label>
      <label>Correo
        <input name="email" type="email" placeholder="usuario@hotel.com" required>
      </label>
      <label>Contraseña
        <input name="password" type="password" minlength="6" placeholder="Mínimo 6 caracteres" required>
      </label>
      <label>Confirmar contraseña
        <input name="password2" type="password" minlength="6" placeholder="Repite la contraseña" required>
      </label>

      <label style="display:flex;gap:8px;align-items:flex-start;margin-top:4px">
        <input name="terms" type="checkbox" required>
        <span>Acepto los términos y condiciones</span>
      </label>

      <button class="btn" type="submit" style="margin-top:8px">Registrarme</button>
      <p style="margin-top:10px">¿Ya tienes cuenta? <a class="module-link" href="./login.html">Inicia sesión</a></p>
    </form>
  </div>
</main>

<footer><small>© 2025 Hoteleaseali</small></footer>

<script type="module" src="./firebase-init.js"></script>
<script type="module">
import { auth } from './firebase-init.js';
import { createUserWithEmailAndPassword, updateProfile }
  from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const $ = (s) => document.querySelector(s);
const form = $('#register-form');

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const name = (form.name.value || '').trim();
  const email = form.email.value.trim();
  const pass  = form.password.value;
  const pass2 = form.password2.value;
  const terms = form.terms.checked;

  if (!terms) return alert('Acepta los términos y condiciones.');
  if (pass !== pass2) return alert('Las contraseñas no coinciden.');

  try {
    const { user } = await createUserWithEmailAndPassword(auth, email, pass);
    if (name) await updateProfile(user, { displayName: name });
    location.href = './panel.html';
  } catch (err) {
    const msgs = {
      'auth/email-already-in-use': 'Ese correo ya está registrado.',
      'auth/invalid-email': 'Correo inválido.',
      'auth/weak-password': 'La contraseña es muy corta.'
    };
    alert(msgs[err.code] || err.message);
  }
});
</script>
  <script type="module" src="./firebase-init.js"></script>
</body>
</html>
